# yaml-language-server: $schema=../repos-config.schema.json
#
# Repository Configuration for Self-Iteration
#
# This file configures per-repository settings for automatic issue
# readiness evaluation. When self-iteration is enabled, ocdc will
# automatically mark issues as ready (add ocdc:ready label) based
# on priority, dependencies, and WIP limits.
#
# Location: ~/.config/ocdc/repos.yaml
#
# Prerequisites:
# - Enable self-iteration in ~/.config/ocdc/config.json:
#   {
#     "self_iteration": {
#       "enabled": true,
#       "ready_label": "ocdc:ready"
#     }
#   }
# - gh CLI authenticated with appropriate permissions

repos:
  # Example: GitHub repository with full configuration
  myorg/backend:
    # Local path to the repository (required)
    repo_path: ~/code/backend
    
    # Issue tracker configuration
    issue_tracker:
      type: github
      repo: myorg/backend  # Can differ from repo key if needed
    
    # Readiness evaluation criteria
    readiness:
      labels:
        # Issues must NOT have any of these labels
        exclude:
          - blocked
          - needs-design
          - needs-review
          - wontfix
        # Issues must have ALL of these labels (optional)
        required: []
        # Issues must have at least ONE of these labels (optional)
        any_of: []
      
      # Priority scoring - higher scores get picked first
      priority:
        labels:
          - label: critical
            weight: 100
          - label: high
            weight: 50
          - label: medium
            weight: 25
          - label: low
            weight: 10
        # Bonus points per day since issue creation (FIFO preference)
        age_weight: 1
      
      # Dependency detection
      dependencies:
        # Check issue body for "blocked by #X" patterns
        check_body_references: true
        # Labels that indicate the issue is blocked
        blocking_labels:
          - blocked
          - waiting-on-external
    
    # WIP (Work In Progress) limits for this repo
    wip_limits:
      max_concurrent: 2
    
    # Comment settings (optional)
    comments:
      on_start: false      # Comment when work starts
      on_pr_created: false # Comment when PR is created

  # Example: Minimal configuration (uses defaults)
  myorg/frontend:
    repo_path: ~/code/frontend
    issue_tracker:
      type: github
      repo: myorg/frontend

  # Example: Different repo path than repo key
  # Useful when local path doesn't match GitHub structure
  acme/shared-lib:
    repo_path: ~/work/libraries/shared
    issue_tracker:
      type: github
      repo: acme-org/shared-library
    wip_limits:
      max_concurrent: 1
